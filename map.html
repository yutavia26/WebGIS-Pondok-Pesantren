<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Lokasi Bangunan Pondok Pesantren Al-Munawwir</title>
        <!-- Favicon-->
        <link rel="icon" type="image/pondok pesantren.png" href="assets/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />

        <!-- LEAFLET -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand" style="color:grey;" href="#!">Pondok Pesantren Al-Munawwir</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars ms-1"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav text-uppercase ms-auto py-4 py-lg-0">
                        <li class="nav-item"><a class="nav-link" href="#kajian">Kajian</a></li>
                        <li class="nav-item"><a class="nav-link" href="#tentang">Tentang Kami</a></li>
                        <li class="nav-item"><a class="nav-link" href="#lokasi">Lokasi</a></li>
                        <li class="nav-item"><a class="nav-link" href="#team">Tim</a></li>
                        <li class="nav-item"><a class="nav-link" href="#contact">Kontak</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Masthead-->
        <header class="masthead">
            <div class="container">
                <div class="masthead-subheading">Lokasi Bangunan Pondok Pesantren Al-Munawwir</div>
                <div class="masthead-heading text-uppercase">Pondok Pesantren Al-Munawwir</div>
                <a class="btn btn-primary btn-xl text-uppercase" href="#kajian">Ketahui Lebih Lanjut</a>
            </div>
        </header>
        <!-- Kajian-->
        <section class="page-section" id="kajian">
            <div class="container">
                <div class="text-center">
                    <h2 class="section-heading text-uppercase">Kajian</h2>
                    <h3 class="section-subheading text-muted">Kajian Rutin Pondok Pesantren Al-Munawwir</h3>
                </div>
                <div class="row text-center">
                    <div class="col-md-4">
                        <span class="fa-stack fa-4x">
                            <i class="fas fa-circle fa-stack-2x text-primary"></i>
                            <i class="fas fa-laptop fa-stack-1x fa-inverse"></i>
                        </span>
                        <h4 class="my-3">Kajian Umum</h4>
                        <p class="text-muted">Berisi kajian umum dengan topik general.</p>
                    </div>
                    <div class="col-md-4">
                        <span class="fa-stack fa-4x">
                            <i class="fas fa-circle fa-stack-2x text-primary"></i>
                            <i class="fas fa-laptop fa-stack-1x fa-inverse"></i>
                        </span>
                        <h4 class="my-3">Khotbah Jum'at</h4>
                        <p class="text-muted">Berisi kajian rutin setiap hari Jum'at.</p>
                    </div>
                    <div class="col-md-4">
                        <span class="fa-stack fa-4x">
                            <i class="fas fa-circle fa-stack-2x text-primary"></i>
                            <i class="fas fa-laptop fa-stack-1x fa-inverse"></i>
                        </span>
                        <h4 class="my-3">Kajian Keakhwatan</h4>
                        <p class="text-muted">Berisi kajian rutin Keakhwatan.</p>
                    </div>
                </div>
            </div>
        </section>
        <!-- Tentang Kami-->
        <section class="page-section" id="tentang">
            <div class="container">
                <div class="text-center">
                    <h2 class="section-heading text-uppercase">Tentang Kami</h2>
                    <h3 class="section-subheading text-muted">Sejarah Pondok Pesantren Al-Munawwir</h3>
                </div>
                <ul class="timeline">
                    <li>
                        <div class="timeline-image"><img class="rounded-circle img-fluid" src="assets/img/about/gerbang lama.png" alt="..." /></div>
                        <div class="timeline-panel">
                            <div class="timeline-heading">
                                <h4>1991 M</h4>
                                <h4 class="subheading">Berdirinya Pondok Pesantren Al-Munawwir</h4>
                            </div>
                            <div class="timeline-body"><p class="text-muted">Pondok Pesantren Al Munawwir didirikan oleh KH. Muhammad Munawwir bin Abdullah Rosyad pada tanggal 15 November 1911 M, sejak awal berdiri dan berkembangnya pondok pesantren ini semula bernama pondok pesantren Krapyak, karena memang terletak di dusun Krapyak.</p></div>
                        </div>
                    </li>
                    <li class="timeline-inverted">
                        <div class="timeline-image"><img class="rounded-circle img-fluid" src="assets/img/about/quran.jpeg" alt="..." /></div>
                        <div class="timeline-panel">
                            <div class="timeline-heading">
                                <h4>1976-an</h4>
                                <h4 class="subheading">Penambahan Nama</h4>
                            </div>
                            <div class="timeline-body"><p class="text-muted">Nama pondok pesantren tersebut ditambah ‘Al-Munawwir’. Penambahan nama ini bertujuan untuk mengenang pendirinya yaitu KH. M. Munawwir. Dan Al-Qur’anlah sebagai ciri khas pendidikan di pesantren ini di awal berdirinya.</p></div>
                        </div>
                    </li>
                    <li class="timeline-inverted">
                        <div class="timeline-image">
                            <h4>
                                Be Part
                                <br />
                                Of Our
                                <br />
                                Story!
                            </h4>
                        </div>
                    </li>
                </ul>
            </div>
        </section>
        <!--Lokasi-->
        <section id="lokasi">
            <div class="container">
                <h2 class="text-center">Peta Lokasi Pondok Pesantren Al-Munawwir</h2>
                <div class="row mt-4">
                    <!-- Petunjuk -->
                    <div class="col-lg-3">
                        <div class="card shadow-sm">
                            <div class="card-header bg-primary text-white fw-bold">Petunjuk</div>
                            <div class="card-body">
                                <p><span>1. Gunakan tombol zoom in <img src="assets/img/lokasi/plus.png" width="20px"> dan
                                    zoom out <img src="assets/img/lokasi/min.png" width="20px">.</span></p>
                                <p><span>2. Titik biru huruf "A" merupakan titik lokasi Anda.</span></p>
                                <p><span>3. Klik tombol lokasi untuk menampilkan lokasi Pondok Pesantren Al-Munawwir.</span></p>
                                <p><span>4. Rute ditampilkan sebagai garis biru pada peta.</span></p>
                                <p><span>5. Ubah layer maps pada simbol "peta" di bagian kanan atas.</span></p>
                                <p><span>6. Pastikan Anda mengizinkan website untuk mengakses lokasi agar rute dapat ditampilkan.</span></p>
                            </div>
                        </div>
                    </div>
                    <!-- Peta -->
                    <div class="col-lg-9">
                        <div class="card shadow-sm">
                            <div class="card-header bg-primary text-white fw-bold d-flex justify-content-between align-items-center">
                                <span>Peta Interaktif</span>
                                <button id="fly" class="btn btn-light btn-sm">Lokasi Pesantren</button>
                            </div>
                            <div class="card-body p-2" style="height: 520px; position: relative;">
                                <div id="map" style="width: 100%; height: 100%; border-radius: 8px;"></div>
                                <div id="state-legend" class="legend" 
                                    style="position:absolute; bottom:10px; left:10px; background:white; padding:10px; border-radius:8px;">
                                <h6 style="font-weight: bold;">Legenda</h6>
                                <div><span style="background-color: rgb(0, 162, 255); width:15px; height:15px; display:inline-block; margin-right:5px;"></span>Asrama Putra</div>
                                <div><span style="background-color: pink; width:15px; height:15px; display:inline-block; margin-right:5px;"></span>Asrama Putri</div>
                                <div><span style="background-color: brown; width:15px; height:15px; display:inline-block; margin-right:5px;"></span>Bangunan Umum</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
</section>
        <!-- Team-->
        <section class="page-section bg-light" id="team">
            <div class="container">
                <div class="text-center">
                    <h2 class="section-heading text-uppercase">Our Amazing Team</h2>
                    <h3 class="section-subheading text-muted">WebGIS Developer</h3>
                </div>
                <div class="center">
                    <div class="center">
                        <div class="team-member">
                            <img class="mx-auto rounded-circle" src="assets/img/team/yuta.jpg" alt="..." />
                            <h4>Yutaviananda Devintha (117230026)</h4>
                            <p class="text-muted">Mahasiswi Teknik Geomatika UPN "Veteran" Yogyakarta</p>
                            <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Parveen Anand Twitter Profile"><i class="fab fa-twitter"></i></a>
                            <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Parveen Anand Facebook Profile"><i class="fab fa-facebook-f"></i></a>
                            <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Parveen Anand LinkedIn Profile"><i class="fab fa-linkedin-in"></i></a>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-8 mx-auto text-center"><p class="large text-muted">"Dalam menuntut ilmu, kesantunan adalah kunci utama meraih pelajaran yang berharga."</p></div>
                </div>
            </div>
        </section>
        <!-- Clients-->
        <div class="py-5">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-2 col-md-4 col-sm-6 my-3">
                        <a href="#!"><img class="img-fluid img-brand d-block mx-auto" src="assets/img/partner/vs.jpeg" alt="..." aria-label="VS Code Logo" /></a>
                    </div>
                    <div class="col-lg-2 col-md-4 col-sm-6 my-3">
                        <a href="#!"><img class="img-fluid img-brand d-block mx-auto" src="assets/img/partner/qgis.png" alt="..." aria-label="QGIS Logo" /></a>
                    </div>
                    <div class="col-lg-2 col-md-4 col-sm-6 my-3">
                        <a href="#!"><img class="img-fluid img-brand d-block mx-auto" src="assets/img/partner/sb.png" alt="..." aria-label="Startbootstrap Logo" /></a>
                    </div>
                    <div class="col-lg-2 col-md-4 col-sm-6 my-3">
                        <a href="#!"><img class="img-fluid img-brand d-block mx-auto" src="assets/img/partner/leaflet.png" alt="..." aria-label="Leaflet Logo" /></a>
                    </div>
                    <div class="col-lg-2 col-md-4 col-sm-6 my-3">
                        <a href="#!"><img class="img-fluid img-brand d-block mx-auto" src="assets/img/partner/ors.png" alt="..." aria-label="OpenRouteService Logo" /></a>
                    </div>
                    <div class="col-lg-2 col-md-4 col-sm-6 my-3">
                        <a href="#!"><img class="img-fluid img-brand d-block mx-auto" src="assets/img/partner/github.png" alt="..." aria-label="GitHub Logo" /></a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Contact-->
        <section class="page-section" id="contact">
            <div class="container">
                <div class="text-center">
                    <h2 class="section-heading text-uppercase">Hubungi Kami</h2>
                    <h3 class="section-subheading text-muted">Hubungi kami jika terdapat pesan yang ingin disampaikan.</h3>
                </div>
                <!-- * * * * * * * * * * * * * * *-->
                <!-- * * SB Forms Contact Form * *-->
                <!-- * * * * * * * * * * * * * * *-->
                <!-- This form is pre-integrated with SB Forms.-->
                <!-- To make this form functional, sign up at-->
                <!-- https://startbootstrap.com/solution/contact-forms-->
                <!-- to get an API token!-->
                <form id="contactForm" data-sb-form-api-token="API_TOKEN">
                    <div class="row align-items-stretch mb-5">
                        <div class="col-md-6">
                            <div class="form-group">
                                <!-- Name input-->
                                <input class="form-control" id="name" type="text" placeholder="Nama *" data-sb-validations="required" />
                                <div class="invalid-feedback" data-sb-feedback="name:required">A name is required.</div>
                            </div>
                            <div class="form-group">
                                <!-- Email address input-->
                                <input class="form-control" id="email" type="email" placeholder="Email *" data-sb-validations="required,email" />
                                <div class="invalid-feedback" data-sb-feedback="email:required">An email is required.</div>
                                <div class="invalid-feedback" data-sb-feedback="email:email">Email is not valid.</div>
                            </div>
                            <div class="form-group mb-md-0">
                                <!-- Phone number input-->
                                <input class="form-control" id="phone" type="tel" placeholder="Nomor HP *" data-sb-validations="required" />
                                <div class="invalid-feedback" data-sb-feedback="phone:required">A phone number is required.</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group form-group-textarea mb-md-0">
                                <!-- Message input-->
                                <textarea class="form-control" id="message" placeholder="Pesan *" data-sb-validations="required"></textarea>
                                <div class="invalid-feedback" data-sb-feedback="message:required">A message is required.</div>
                            </div>
                        </div>
                    </div>
                    <!-- Submit success message-->
                    <!---->
                    <!-- This is what your users will see when the form-->
                    <!-- has successfully submitted-->
                    <div class="d-none" id="submitSuccessMessage">
                        <div class="text-center text-white mb-3">
                            <div class="fw-bolder">Form submission successful!</div>
                            To activate this form, sign up at
                            <br />
                            <a href="https://startbootstrap.com/solution/contact-forms">https://startbootstrap.com/solution/contact-forms</a>
                        </div>
                    </div>
                    <!-- Submit error message-->
                    <!---->
                    <!-- This is what your users will see when there is-->
                    <!-- an error submitting the form-->
                    <div class="d-none" id="submitErrorMessage"><div class="text-center text-danger mb-3">Error sending message!</div></div>
                    <!-- Submit Button-->
                    <div class="text-center"><button class="btn btn-primary btn-xl text-uppercase disabled" id="submitButton" type="submit">Kirimkan Pesan</button></div>
                </form>
            </div>
        </section>
        <!-- Footer-->
        <footer class="footer py-4">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-4 text-lg-start">Copyright &copy; Pondok Pesantren Al-Munawwir 2025</div>
                    <div class="col-lg-4 my-3 my-lg-0">
                        <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a class="btn btn-dark btn-social mx-2" href="#!" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                    <div class="col-lg-4 text-lg-end">
                        <a class="link-dark text-decoration-none me-3" href="#!">Privacy Policy</a>
                        <a class="link-dark text-decoration-none" href="#!">Terms of Use</a>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
        <!-- SB Forms -->
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>

        <!-- LEAFLET SCRIPT -->
        <script>
        // === Inisialisasi Peta ===
        const map = L.map('map').setView([-7.82646, 110.36141], 16);

        // === Base Layers ===
        const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        const esri = L.tileLayer(
            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
            { maxZoom: 19, attribution: 'Tiles &copy; Esri' }
        );

        // === Titik Pesantren ===
        const pesantrenLatLng = [-7.82644, 110.36151];
        const pesantrenMarker = L.marker(pesantrenLatLng)
            .addTo(map)
            .bindPopup("<b>Pesantren Al-Munawwir</b><br>Tujuan Anda");

        // === Layer GeoJSON (langsung tampil) ===
        const asramaPutra = L.geoJSON(null, {
            style: f => ({ color: 'black', weight: 1, fillColor: 'rgb(0,162,255)', fillOpacity: 0.6 }),
            onEachFeature: (f, l) => f.properties?.name && l.bindPopup(f.properties.name)
        }).addTo(map);
        fetch('assets/geojson/Asrama Putra.geojson').then(r => r.json()).then(d => asramaPutra.addData(d));

        const asramaPutri = L.geoJSON(null, {
            style: f => ({ color: 'black', weight: 1, fillColor: 'pink', fillOpacity: 0.6 }),
            onEachFeature: (f, l) => f.properties?.name && l.bindPopup(f.properties.name)
        }).addTo(map);
        fetch('assets/geojson/Asrama Putri.geojson').then(r => r.json()).then(d => asramaPutri.addData(d));

        const bangunanUmum = L.geoJSON(null, {
            style: f => ({ color: 'black', weight: 1, fillColor: 'brown', fillOpacity: 0.6 }),
            onEachFeature: (f, l) => f.properties?.name && l.bindPopup(f.properties.name)
        }).addTo(map);
        fetch('assets/geojson/Bangunan Umum.geojson').then(r => r.json()).then(d => bangunanUmum.addData(d));

        // === Skala ===
        L.control.scale().addTo(map);

        // === Legenda dengan background ===
        const legend = L.control({ position: "bottomleft" });
        legend.onAdd = function () {
            const div = L.DomUtil.create("div", "legend");
            div.innerHTML = `
                <h6 style="font-weight:bold;margin-bottom:5px;">Legenda</h6>
                <div><span style="background-color:rgb(0,162,255);width:15px;height:15px;display:inline-block;margin-right:5px;border:1px solid #000;"></span>Asrama Putra</div>
                <div><span style="background-color:pink;width:15px;height:15px;display:inline-block;margin-right:5px;border:1px solid #000;"></span>Asrama Putri</div>
                <div><span style="background-color:brown;width:15px;height:15px;display:inline-block;margin-right:5px;border:1px solid #000;"></span>Bangunan Umum</div>
            `;
            return div;
        };
        legend.addTo(map);

        // === Tombol Ganti Layer (kanan atas) ===
        const layerButton = L.control({ position: 'topright' });
        layerButton.onAdd = function () {
            const container = L.DomUtil.create('div', 'layer-button');
            container.innerHTML = `
                <div id="layerToggle" class="layer-toggle">🗺️</div>
                <div id="layerMenu" class="layer-menu">
                    <div class="option" data-layer="osm">OpenStreetMap</div>
                    <div class="option" data-layer="esri">Esri Imagery</div>
                </div>
            `;

            const toggle = container.querySelector('#layerToggle');
            const menu = container.querySelector('#layerMenu');

            toggle.addEventListener('click', e => {
                menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
                e.stopPropagation();
            });

            document.addEventListener('click', () => {
                menu.style.display = 'none';
            });

            menu.querySelectorAll('.option').forEach(opt => {
                opt.addEventListener('click', e => {
                    const layer = e.target.getAttribute('data-layer');
                    if (layer === 'osm') {
                        map.removeLayer(esri);
                        osm.addTo(map);
                    } else if (layer === 'esri') {
                        map.removeLayer(osm);
                        esri.addTo(map);
                    }
                    menu.style.display = 'none';
                });
            });

            return container;
        };
        layerButton.addTo(map);

        // === Lokasi & Rute ===
        let routeLine = null;
        let infoBox = null;

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                pos => {
                    const userLatLng = [pos.coords.latitude, pos.coords.longitude];

                    const userMarker = L.marker(userLatLng, {
                        icon: L.divIcon({
                            html: '<div style="background:#007bff;color:white;border-radius:50%;width:25px;height:25px;display:flex;align-items:center;justify-content:center;font-weight:bold;">A</div>',
                            className: 'user-marker', iconSize: [25, 25]
                        })
                    }).addTo(map).bindPopup("<b>Titik A</b><br>Lokasi Anda Saat Ini");

                    getRoute(userLatLng, pesantrenLatLng);

                    const flyBtn = document.getElementById("fly");
                    if (flyBtn) {
                        flyBtn.addEventListener("click", () => {
                            map.flyTo(pesantrenLatLng, 18, { animate: true, duration: 2 });
                            pesantrenMarker.openPopup();
                        });
                    }
                },
                () => alert("Gagal mengambil lokasi. Pastikan izin lokasi aktif.")
            );
        } else {
        alert("Browser tidak mendukung Geolocation.");
    }

        // === Fungsi Ambil Rute ===
        function getRoute(start, end) {
            const url = `https://router.project-osrm.org/route/v1/driving/${start[1]},${start[0]};${end[1]},${end[0]}?overview=full&geometries=geojson`;

            fetch(url)
                .then(res => res.json())
                .then(data => {
                    if (!data.routes?.length) {
                        alert("Rute tidak ditemukan.");
                        return;
                    }
                    const route = data.routes[0];
                    const coords = route.geometry.coordinates.map(c => [c[1], c[0]]);

                    if (routeLine) map.removeLayer(routeLine);
                    routeLine = L.polyline(coords, { color: "blue", weight: 5, opacity: 0.9 }).addTo(map);

                    const distanceKm = (route.distance / 1000).toFixed(2);
                    const durationMin = (route.duration / 60).toFixed(1);

                    map.flyToBounds(routeLine.getBounds(), { padding: [50, 50], animate: true, duration: 1.5 });

                    if (infoBox) map.removeControl(infoBox);
                    infoBox = L.control({ position: "bottomright" });
                    infoBox.onAdd = () => {
                        const div = L.DomUtil.create("div", "info-box");
                        div.innerHTML = `
                            <b>Rute ke Pesantren</b><br>
                            Jarak: ${distanceKm} km<br>
                            Waktu: ${durationMin} menit
                        `;
                        return div;
                    };
                    infoBox.addTo(map);
                })
                .catch(err => console.error(err));
            }
        </script>
    </body>
</html>
